# YooKassa Tax Bot –¥–ª—è –ù–ü–î

Telegram-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–µ—Å—Ç—Ä–æ–≤ YooKassa –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –≤ ¬´–ú–æ–π –Ω–∞–ª–æ–≥¬ª (—Å–∞–º–æ–∑–∞–Ω—è—Ç—ã–µ).

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—á—Ç—ã (1 —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏) –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ CSV-—Ä–µ–µ—Å—Ç—Ä–æ–≤
- –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–µ—Å—Ç—Ä–æ–≤ –±–µ–∑ pandas (—Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π csv)
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ù–ü–î: –≥–æ—Ç–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–Ω–µ—Å–µ–Ω–∏—è –≤ ¬´–ú–æ–π –Ω–∞–ª–æ–≥¬ª
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è: –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–¥–Ω–æ –ø–∏—Å—å–º–æ –¥–≤–∞–∂–¥—ã
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ admin ID –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞
- Long polling: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook/nginx
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤, –ª–∏–º–∏—Ç –ù–ü–î, –∏—Å—Ç–æ—Ä–∏—è —Ä–µ–µ—Å—Ç—Ä–æ–≤
- –õ—ë–≥–∫–∏–π: 1 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, SQLite, –º–∏–Ω–∏–º—É–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Telegram-–±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather)
2. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞: `/newbot` ‚Üí —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **—Ç–æ–∫–µ–Ω** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `1234567890:ABCdefGHIjklMNOpqrsTUVwxyz`)
4. –£–∑–Ω–∞–π—Ç–µ —Å–≤–æ–π **Telegram ID**: [@userinfobot](https://t.me/userinfobot)

**–ú–µ–Ω—é –∫–æ–º–∞–Ω–¥ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞!

---

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ IMAP

#### Gmail
1. –í–∫–ª—é—á–∏—Ç–µ IMAP: [Gmail Settings](https://mail.google.com/mail/u/0/#settings/fwdandpop)
2. –°–æ–∑–¥–∞–π—Ç–µ App Password: [Google Account](https://myaccount.google.com/apppasswords)
3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è `.env`:
```env
IMAP_HOST=imap.gmail.com
IMAP_PORT=993
IMAP_USER=your-email@gmail.com
IMAP_PASSWORD=your-app-password
```

#### Yandex
1. –í–∫–ª—é—á–∏—Ç–µ IMAP: [Yandex Settings](https://mail.yandex.ru/#setup/client)
2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è `.env`:
```env
IMAP_HOST=imap.yandex.ru
IMAP_PORT=993
IMAP_USER=your-email@yandex.ru
IMAP_PASSWORD=your-password
```

#### Mail.ru
1. –í–∫–ª—é—á–∏—Ç–µ IMAP: [Mail.ru Settings](https://e.mail.ru/settings/userinfo)
2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è `.env`:
```env
IMAP_HOST=imap.mail.ru
IMAP_PORT=993
IMAP_USER=your-email@mail.ru
IMAP_PASSWORD=your-password
```

---

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
cd /opt && sudo git clone https://github.com/YOUR_USERNAME/yookassa-tax-bot.git && cd yookassa-tax-bot && sudo cp .env.example .env && sudo nano .env

# –ó–∞–ø—É—Å–∫
sudo docker compose up -d && sudo docker compose logs -f
```

---

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `.env`

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```env
# Telegram
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
ADMIN_IDS=123456789,987654321  # –ß–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–æ–≤

# IMAP (—Å–º. –ø—Ä–∏–º–µ—Ä—ã –≤—ã—à–µ –¥–ª—è Gmail/Yandex/Mail.ru)
IMAP_HOST=imap.gmail.com
IMAP_PORT=993
IMAP_USER=your-email@gmail.com
IMAP_PASSWORD=your-app-password
```

#### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```env
# –§–∏–ª—å—Ç—Ä—ã –ø–æ—á—Ç—ã
EMAIL_FROM_FILTER=reports@yoomoney.ru  # –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º)
EMAIL_SUBJECT_FILTER=–†–µ–µ—Å—Ç—Ä             # –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –≤ —Ç–µ–º–µ (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º)
DAYS_TO_CHECK=7                         # –°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –Ω–∞–∑–∞–¥ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–∏—Å—å–º–∞
ALLOWED_EXTENSIONS=.csv                 # –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤–ª–æ–∂–µ–Ω–∏–π (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)

# –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—á—Ç—ã
TIMEZONE=Europe/Moscow                  # –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
DAILY_HOUR=10                           # –ß–∞—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ (0-23)
DAILY_MINUTE=0                          # –ú–∏–Ω—É—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ (0-59)

# –û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –Ω–∞–ª–æ–≥–æ–≤–æ–π
TAX_DESCRIPTION=–î–æ—Å—Ç—É–ø –∫ IT-—Å–µ—Ä–≤–∏—Å—É (–ø–æ–¥–ø–∏—Å–∫–∞)

# –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
NOTIFY_EMPTY_REGISTRIES=true            # true/false - —É–≤–µ–¥–æ–º–ª—è—Ç—å –æ –ø—É—Å—Ç—ã—Ö —Ä–µ–µ—Å—Ç—Ä–∞—Ö

# –õ–∏–º–∏—Ç –ù–ü–î (–≥–æ–¥–æ–≤–æ–π)
NPD_YEARLY_LIMIT=2400000                # –õ–∏–º–∏—Ç –¥–æ—Ö–æ–¥–∞ –¥–ª—è —Å–∞–º–æ–∑–∞–Ω—è—Ç—ã—Ö (RUB)

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=INFO                          # DEBUG/INFO/WARNING/ERROR
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:

- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
- `/run` ‚Äî –≤—Ä—É—á–Ω—É—é –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ—á—Ç—ã
- `/status` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–ø–∏—Å—å–º–∞, —Ñ–∞–π–ª—ã)
- `/stats` ‚Äî –¥–æ—Ö–æ–¥—ã –ù–ü–î (–º–µ—Å—è—Ü, –≥–æ–¥, –ª–∏–º–∏—Ç)
- `/history` ‚Äî –∏—Å—Ç–æ—Ä–∏—è —Ä–µ–µ—Å—Ç—Ä–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 15)
- `/settings` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –æ–ø–∏—Å–∞–Ω–∏–µ)

### –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ—á—Ç—É –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ `DAILY_HOUR:DAILY_MINUTE` –ø–æ `TIMEZONE`.

–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —Ä–µ–µ—Å—Ç—Ä–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
```
üìä –†–µ–µ—Å—Ç—Ä –æ—Ç 2026-01-15

üí∞ –î–æ—Ö–æ–¥: 1,245.50 RUB
üì¶ –ü–ª–∞—Ç–µ–∂–µ–π: 12
üí∏ –ö–æ–º–∏—Å—Å–∏—è: 31.14 RUB (—Å–ø—Ä–∞–≤–æ—á–Ω–æ)

–î–ª—è ¬´–ú–æ–π –Ω–∞–ª–æ–≥¬ª:
2026-01-15 ‚Äî 1245.50 RUB ‚Äî –î–æ—Å—Ç—É–ø –∫ IT-—Å–µ—Ä–≤–∏—Å—É

[üìä –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏] [üìÑ –°–∫–∞—á–∞—Ç—å CSV] [üóë –£–¥–∞–ª–∏—Ç—å]
```

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (–æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π)
```bash
cd /opt/yookassa-tax-bot && sudo git pull && sudo docker compose down && sudo docker compose up -d --build
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo docker compose logs -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo docker compose restart

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
sudo docker compose down

# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
sudo docker compose down && sudo docker compose up -d --build --force-recreate

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
sudo docker stats yookassa-tax-bot
```